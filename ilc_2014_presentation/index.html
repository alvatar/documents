<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Gambit / SchemeSpheres | ILC 2014</title>

    <meta name="description" content="Multiplatform and Mobile App Development in Scheme with Gambit/SchemeSpheres">
    <meta name="author" content="Álvaro Castro-Castilla">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/sky.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
      if( window.location.search.match( /print-pdf/gi ) ) {
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = 'css/print/pdf.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
      }
    </script>

    <!--[if lt IE 9]>
	<script src="lib/js/html5shiv.js"></script>
	<![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
	<section>
	  <h3>Multiplatform and Mobile<br />App Development in Scheme<br /> with</h3>
          <h2><strong><a href="http://schemespheres.org">Gambit / SchemeSpheres</a></strong></h2>
          <br />
          <p><small>Álvaro Castro-Castilla <a href="https://twitter.com/alvatarc">@alvatarc</a><br /><a href="http://fourthbit.com">Fourthbit</a></small></p>
	</section>

        <section>
	  <h2>Overview</h2>
          <ol>
            <li>Introduction</li>
            <li>Overview of the system</li>
            <li>Getting Started with Gambit/SchemeSpheres</li>
            <li>Building an app for Linux / OSX</li>
            <li>Building an app for Android / iOS</li>
          </ol>
        </section>

        <section data-background="#a9dadb">
	  <h1>Introduction</h1>
        </section>

        <section data-background="#a9dadb">
          <h2>Gambit Scheme compiler</h2>
          <ul>
            <li>R5RS Scheme compiler</li>
            <li>Great <strong>performance</strong> with optimized code</li>
            <li>C backend, FFI, no external library dependencies, portable</li>
            <li>Upcoming: <strong>universal backend</strong> (JavaScript, PHP, Python, Ruby)</li>
          </ul>
        </section>


        <section data-background="#a9dadb">
          <h2>SchemeSpheres</h2>
          <br />
          <ul>
            <li>The project, evolution, roadmap</li>
            <li>Features and basic usage</li>
            <li>Tutorials: interactive usage, multiplatform and mobile development</li>
          </ul>
        </section>
        
        <section data-background="#a9dadb">
          <h2>Construction of multiplatform projects</h2>
          <ul>
            <li>How to handle dependencies</li>
            <li>How to handle platform-specific code</li>
            <li>Static, dynamically-loaded and interpreted code</li>
            <li>The experience of building SchemeSpheres</li>
          </ul>
        </section>

        <section data-background="#a9dadb">
          <h2>Interactive development for mobile platforms</h2>
          <ul>
            <li>Mobile platform development</li>
            <li>Remote debugging</li>
            <li>Interactive development and deployment</li>
          </ul>
        </section>

        <!-- SECTION 2 -->

        <section data-background="#f97e7e">
          <h1>Getting Started</h1>
          <h2>with <strong>SchemeSpheres</strong></h2>
        </section>

        <section data-background="#f97e7e">
          <h2>Origin of the project</h2>
          <h3>the potential of...</h3>
          <ol>
            <li>providing <strong>self-contained</strong> set of libraries and standard SRFIs</li>
            <li><strong>integrating</strong> mobile and desktop platforms development</li>
            <li>while <strong>exposing</strong> Gambit's facilities and flexibility</li>
          </ol>
        </section>
        
        <section data-background="#f97e7e">
          <h2>...additionally,</h2>
          <h3>aim at providing</h3>
          <ol>
            <li>project structure <strong>templates and build tasks</strong> for all platforms, without hiding the details and allowing full customization per-project.</li>
            <li>project <strong>construction automation</strong>, in all development platforms, for the different targets available in each.</li>
            <li><strong>dependency handling</strong> and some form of package specification, so the system favours reusability and code sharing.</li>
            <li>a common <strong>documentation system</strong>, manuals and guides.</li>
          </ol>
        </section>

        
        <section data-background="#f97e7e">
          <h2>Requirements</h2>
          <ol>
            <li>Complete control over the workflow and build process, as opposed to typical module systems.</li>
            <li>Take advantage of multiple backends and execution models.</li>
            <li>Support for syntax-rules.</li>
            <li>Support for low-level macros (define-macros/syntax-case/rsc-macro-transformer)</li>
            <li>Module system or namespaces</li>
          </ol>
        </section>
        
        <section data-background="#f97e7e">
          <h2>In Summary</h2>
          <br />
          <h3><strong>A package manager, project scaffolding tool, task runner and a set of libraries for the Gambit Scheme compiler. <br />
              Multiplatform and mobile.</strong></h3>
        </section>

        <section data-background="#f97e7e">
          <h2>What makes it possible with SchemeSpheres?</h2>
          <h3>the project is divided into</h3>
          <ul>
            <li>Hygienic macro expansion, modules and conditional compilation</li>
            <li>Workflow tool-chain (<strong>sfusion</strong>, <strong>ssake</strong>, <strong>sspheres</strong>)</li>
            <li>Ecosystem (<strong>libraries</strong>, <strong>documentation</strong>)</li>
          </ul>
        </section>

        <section data-background="#f97e7e">
          <h2>Let's get our first taste of SchemeSpheres</h2>
        </section>

        <!-- SECTION 3 -->
        
        <section data-background="#becd9a">
          <h1>Tutorial:</h1>
          <h2>SchemeSpheres<br />interactive usage</h2>
        </section>
        
        <section data-background="#becd9a">
          <h2>Installation</h2>
          <h3><a href="http://www.schemespheres.org/guides/en/quickstart" target="_blank">Getting started guide</a></h3>
        </section>

        <section data-background="#becd9a">
          <h2>Interactive REPL</h2>
          <h3>Basic example: Currying</h3>
          <pre><code data-trim contenteditable>
;; Currying
(##spheres-load core: functional)

;; at this point, the functions from (core: functional) are available
(define addtwo (curry + 2))
(addtwo 7)
</code></pre>
        </section>

        <section data-background="#becd9a">
          <h2>Installing more Spheres</h2>
          <h3><a href="http://www.schemespheres.org/spheres" target="_blank">Spheres listing</a></h3>
          <pre><code data-trim contenteditable>
sudo sspheres install fabric

# To install OpenGL and SDL2, you need the C libraries in the system.
# In OS X:
brew install sdl2 sdl2_image sdl2_mixer sdl2_net sdl2_ttf glew
sudo sspheres install opengl sdl2
</code></pre>
        </section>

        <section data-background="#becd9a">
          <h2>Interactive REPL</h2>
          <h3>Deeper dependencies example</h3>
          <pre><code data-trim contenteditable>
;; Random sampling and selection (fabric: algorithm/random)
;; Loading the module automatically loads the dependency tree as well
(##spheres-load fabric: algorithm/random)

;; at this point, the functions are available
(random-pick '(a b c d e f))
(random-extract '(a b c d e f))
(random-sample 2 '(a b c d e f))
</code></pre>
        </section>

        <section data-background="#becd9a">
          <h2>Interactive REPL</h2>
          <h3>Foreign dependencies example: SDL / Opengl</h3>
          <pre><code data-trim contenteditable>
;; SDL
(##spheres-load sdl2: sdl2)
;; OpenGL
(##spheres-load opengl: gl)

(SDL_Init 0)
(SDL_CreateWindow "HELLO FROM SDL!" 0 0 500 500 SDL_WINDOW_OPENGL)
(SDL_GL_CreateContext #)
(glGetString GL_VERSION)
(*->string #)
</code></pre>
        </section>

        <section data-background="#becd9a">
          <h2>Hygienic macros</h2>
          <h3>syntax-rules / syntax-case</h3>
          <pre><code data-trim contenteditable>
(##spheres-include core: base-macros)

(when #t
      (println "the basic")
      (println "'when'")
      (println "macro"))

(define varproc
  (case-lambda (() (println "zero arguments"))
               ((a) (println a))))
(varproc)
(varproc "one argument")
</code></pre>
        </section>

        <section data-background="#becd9a">
          <h2>Unhygienic macros</h2>
          <h3>define-macro</h3>
          <pre><code data-trim contenteditable>
(##spheres-include core: base-macros)

;; SRFI-89 variation
(define* (dabuti (red #f) (wine 3))
  (when red (* wine 4)))

(dabuti #t)
(dabuti #t 2)
</code></pre>
        </section>

        <section data-background="#becd9a">
          <h2>Things to take<br /> into account<br />in the REPL...</h2>
        </section>

        <section data-background="#becd9a">
          <h3>code changes introduced by the macro expander</h3>
          <ol>
            <li>explicit <strong>let to lambda</strong> expansion</li>
            <li>variable renaming <strong>(alpha conversion)</strong></li>
            <li>any kind of complex macro/large expansion</li>
          </ol>       
        </section>

        <section data-background="#becd9a">
          <h2>Debugging</h2>
          <pre><code data-trim contenteditable>
(define (foo a) (let ((b 0)) (+ b a)))
(define (bar a) (let ((b 0)) (+ (foo a) b)))

(bar "a")
</code></pre>

<pre>
*** ERROR IN #<procedure #2>, (console)@2.33 -- (Argument 2) NUMBER expected
(+ 0 "a")
1> ,e
%%b3 = 0
%%a2 = "a"
1> ,i
#<procedure #2> =
(lambda (%%b3) (+ (foo %%a2) %%b3))
</pre>
        </section>

        <section data-background="#becd9a">
          <h2>cond-expand</h2>
          <h3>should be declared manually</h3>
          <pre><code data-trim contenteditable>
(##spheres-include core: base-macros)

;; Witout any added expansion feature
(cond-expand
 (my-condition
  (display "my-condition is met\n"))
 (else
  (display "no condition is met\n")))

;; After adding "my-condition" expansion feature
(add-cond-expand-feature! my-condition)

(cond-expand
 (my-condition
  (display "my-condition is met\n"))
 (else
  (display "no condition is met\n")))
</code></pre>
        </section>

        <section data-background="#becd9a">
          <h3>Macro definition / expansion <br />errors in REPL</h3>
<pre><code data-trim contenteditable>
(let (()) 'a)

</code></pre>
<pre>
*** ERROR IN (console)@3.1 -- Syntax expansion failure:
 invalid syntax '(let (()) 'a)
</pre>

<pre><code data-trim contenteditable>
(define-syntax asdf (syntax-rules () ((_) 0) ((_ (m 0)))))
</code></pre>
<pre>
*** ERROR IN (console)@9.21 -- Syntax expansion failure:
 invalid syntax '(syntax-rules () ((_) 0) ((_ (m 0))))
</pre>
        </section>





        <!-- SECTION 4 -->





        <section data-background="#febdff">
          <h1>Building<br /> applications<br /> Linux / OSX</h1>
        </section>

        <section data-background="#febdff">
          <h1>Tutorial:<br /> minimal</h1>
          <h2>project</h2>
        </section>

        <section data-background="#febdff">
          <h2>Sfusion</h2>
          <p>Usage</p>
        </section>

        <section data-background="#febdff">
          <h2>Creating a <strong>minimal</strong> project</h2>
        </section>

        <section data-background="#febdff">
          <h2>Ssake</h2>
          <p>Usage</p>
        </section>

        <section data-background="#febdff">
          <h2>common tasks</h2>
          <ul>
            <li>ssake</li>
            <li>ssake host:run</li>
            <li>ssake host:compile</li>
          </ul>
        </section>

        <section data-background="#febdff">
          <h2>Adding dependencies</h2>
          <h3>config.scm</h3>
          <table>
            <tr>
              <td><strong>include</strong></td>
              <td>use</td>
            </tr>
            <tr>
              <td>prelude</td>
              <td>use</td>
            </tr>
            <tr>
              <td><strong>load</strong></td>
              <td>use</td>
            </tr>
            <tr>
              <td>cc-options</td>
              <td>use</td>
            </tr>
            <tr>
              <td>ld-options</td>
              <td>use</td>
            </tr>
          </table>
        </section>

        <section data-background="#febdff">
          <h1>Tutorial: <br />SDL / OpenGL</h1>
          <h2>project</h2>
        </section>

        <section data-background="#febdff">
          <h2>Creating a<br /> minimal <strong>SDL / OpenGL</strong> project</h2>
        </section>

        <section data-background="#febdff">
          <h2>Inside the project</h2>
          <ul>
            <li>config.scm</li>
            <li>sakefile.scm</li>
          </ul>
        </section>

        <section data-background="#febdff">
          <h2><strong>Foreign</strong> Function<br /> Interface <br /> and<br /> <strong>memory</strong> management</h2>
        </section>

        <section data-background="#febdff">
          <pre><code data-trim contenteditable>
(let ((mode* (alloc-SDL_DisplayMode))) ; <--- allocate an SDL_DisplayMode
    (when (< (SDL_Init SDL_INIT_VIDEO) 0) (fusion:error "Couldn't initialize SDL!"))
    (SDL_GetDisplayMode 0 0 mode*)
    (let* ((screen-width (SDL_DisplayMode-w mode*))
           (screen-height (SDL_DisplayMode-h mode*))
           (window (SDL_CreateWindow
                    "SDL/GL" SDL_WINDOWPOS_CENTERED SDL_WINDOWPOS_CENTERED screen-width screen-height
                    (bitwise-ior SDL_WINDOW_OPENGL SDL_WINDOW_RESIZABLE))))
      (let ((event (alloc-SDL_Event)) ; <--- allocate an SDL_Event
            (ctx (SDL_GL_CreateContext window)))
        (let recur ((iteration 0))
          (SDL_PollEvent event)
          (glClear (bitwise-ior GL_COLOR_BUFFER_BIT GL_DEPTH_BUFFER_BIT GL_STENCIL_BUFFER_BIT))
          (SDL_GL_SwapWindow window)
          (unless (= SDL_QUIT (SDL_Event-type event))
                  (recur (++ iteration))))))) ; <--- leave and release both
          </code></pre>
        </section>

        <section data-background="#febdff">
          <h2>Moving to mobile...</h2>
        </section>




        <!-- SECTION 5 -->



        
        <section data-background="#ffcb87">
          <h1>Building Apps<br />Android / iOS</h1>
        </section>

        <section data-background="#ffcb87">
          <h1>Tutorial:<br /> compilation</h1>
          <h2>for mobile platforms</h2>
        </section>

        <section data-background="#ffcb87">
          <h2>Building and Running the app</h2>
        </section>

        <section data-background="#ffcb87">
          <h2>How it works?</h2>
          <h4><strong>sakefile</strong> tasks</h3>
          <h4><strong>templates</strong> and text file generation</h4>
          <h4><strong>cond-expand</strong> features</h4>
        </section>

        <section data-background="#ffcb87">
          <h1>Tutorial:<br /> mobile <br />interactive</h1>
          <h2>development</h2>
        </section>

        <section data-background="#ffcb87">
          <h2>Development<br /> strategy</h2>
          <img alt="asdf" style="border:0;" src="images/mobile_dev.png"/>
        </section>

        <section data-background="#ffcb87">
          <h2>Deployment<br /></h2>
          <img alt="" style="border:0;" src="images/mobile_deployment.png"/>
        </section>

        <section data-background="#ffcb87">
          <h2>The three components</h2>
          <h3>of multiplatform development<h3>
          <h4>(summing up)</h4>
        </section>

        <section data-background="#ffcb87">
          <h3><strong>sakefile</strong>.scm</h3>
          <h3><strong>config</strong>.scm</h3>
          <h3><strong>cond-expand</strong> features</h3>
        </section>

        <section data-background="#ffcb87">
           <h2>Creating an <strong>SDL / OpenGL</strong> project</h2>
        </section>

        <section data-background="#ffcb87">
          <h2>Running and compiling</h2>
          <h3>for the <strong>host</strong> platform</h3>
          <p>(inspect the three components)</p>
          <pre><code data-trim contenteditable>
# Run as interpreted code + loadable objects (when available)
ssake host:run

# Compile into a single binary
ssake host:compile
          </code></pre>
          </section>

        <section data-background="#ffcb87">
          <h2>The remote</h2>
          <h1>REPL</h1>
        </section>

        <section data-background="#ffcb87">
          <h2>Terminal</h2>
<pre><code data-trim contenteditable>
# Run the REPL server in a terminal
sense
</code></pre>
        </section>

        <section data-background="#ffcb87">
          <h2>Emacs</h2>
          <h3>Install <strong>sense-emacs</strong></h3>
          <p>(found in <strong>Energy</strong> sphere's path)</p>
<pre><code data-trim contenteditable>
(let ((sense-emacs "/usr/local/Gambit-C/spheres/energy/src/remote/sense-emacs.el" ))
  (message "Emacs Sense loaded")
  (load-file sense-emacs))
</code></pre>
<pre><code data-trim contenteditable>
M-x sense
</code></pre>
        </section>

        <section data-background="#ffcb87">
          <h2>Remote</h2>
          <h3>running / updating</h3>
<pre><code data-trim contenteditable>
(go)
</code></pre>
        </section>

        <section data-background="#ffcb87">
          <h2>Updating<br /> vs<br /> re-evaluating</h2>
          <p>in <strong>Emacs</strong></p>
<pre><code data-trim contenteditable>
C-c-e
</code></pre>
        </section>

        <section data-background="#ffcb87">
          <h2>Updating the world<br /> <strong>live!</strong><br /> :)</h2>
<pre><code data-trim contenteditable>
TODO
</code></pre>
        </section>

        <section data-background="#ffcb87">
          <h2>Deployment</h2>
          <h3>as a <strong>monolithing</strong> and <strong>optimized</strong> app</h3>
          <p>(see cond-expand and sakefile)</p>
        </section>

        <section data-background="#ffcb87">
          <h2>Development utilities</h2>
        </section>

        <section data-background="#ffcb87">
          <h2>Fusion sphere</h2>
          <h3>platform-specific modules</h3>
<pre><code data-trim contenteditable>
TODO
</code></pre>
        </section>

        <section data-background="#ffcb87">
          <h2>Thread inspection</h2>
<pre><code data-trim contenteditable>
(##spheres-load energy: inspect)

(thread-start!
 (make-thread
  (lambda ()
    (define a 1234567890987654321)
    (let recur ((a a))
      (if (= 0 a)
          'bye
          (recur (- a 2)))))))

(inspect-thread #2)
</code></pre>
        </section>



        <!-- APPENDIX -->



        <section data-background="#becd9a">
          <h1>The<br /> Spheres</h1>
        </section>

        <section data-background="#becd9a">
          <h2>Core Sphere</h2>
          <ul>
            <li>Assert</li>
            <li>Base macros (SRFIs and general use macros)</li>
            <li>FFI generation and utilities</li>
            <li>Functional programming</li>
            <li>Lazy (SRFI-45)</li>
            <li>Match</li>
            <li>Lightweight testing (SRFI-78)</li>
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>Energy Sphere</h2>
          <h3>Extension to Core's infrastructure</h3>
          <ul>
            
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>Fabric Sphere</h2>
          <h3>Algorithms and Data Structures</h3>
          <ul>
            
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>Fusion Sphere</h2>
          <h3>Multiplatform development</h3>
          <ul>
            
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>Strings Sphere</h2>
          <h3>String handling and related</h3>
          <ul>
            
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>Codec Sphere</h2>
          <h3>Co/decs</h3>
          <ul>
            
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>Crypto Sphere</h2>
          <h3>Cryptographic algorithms</h3>
          <ul>
            
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>Math Sphere</h2>
          <h3>Math function</h3>
          <ul>
            
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>Object Sphere</h2>
          <h3>Object systems</h3>
          <ul>
            
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>FFI spheres</h2>
          <ul>
            <li>OpenGL</li>
            <li>SDL2</li>
            <li>Cairo</li>
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>WIP spheres</h2>
          <ul>
            <li>Concurrency</li>
            <li>Database</li>
            <li>Geometry</li>
            <li>Logic</li>
            <li>Net</li>
            <li>Parsers</li>
            <li></li>
          </ul>
        </section>

        <section data-background="#becd9a">
          <h2>All of which are<br /><strong> multiplatform</strong></h2>
        </section>

        <section data-background="#becd9a">
          <h2>Inside a Sphere...</h2>
          <h4>config.scm</h4>
          <h4>sakefile.scm</h4>
          <h4>modules</h4>
          <h3>...<a href="" target="_blank">How do Spheres work?</a></h3>
        </section>



        <!-- END -->



        <section>
          <h1>The End</h1>
          <h2>Thank you!</h2>
        </section>

      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
      controls: true,
      progress: true,
      history: true,
      center: true,

      theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
      transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

      // Parallax scrolling
      // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
      // parallaxBackgroundSize: '2100px 900px',

      // Optional libraries used to extend on reveal.js
      dependencies: [
      { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
      ]
      });

    </script>

  </body>
</html>
